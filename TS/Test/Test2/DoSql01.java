import stock.db.*;
import java.io.*;
import java.net.*;
import java.sql.*;

public class DoSql01 {
 static String[] qsnum = {
 	"5508","3514","3546","6240","4408","6163","3383","6182","4907","3317","5506","6244","6237","2705","2496","3043","3519","3534","2396","8913","2397","6122","1538","8234","1441","2465","8121","6209","3207","2020","5706","3126","2478","6104","1903","6609","3452","6294","3016","2484","3050","3051","6264","2524","5514","2704","1584","2342","5701","2344","5474","3006","8085","5387","5348","2534","3086","1902","2913","4120","3499","2495","5534","5483","6177","2505","3268","6221","2702","3259","5304","1414","5443","8064","3171","2847","6229","3306","1443","3236","4722","2545","8076","6125","5522","6263","6266","1536","1611","2911","3188","3512","2031","5213","3276","3504","6245","2332","2706","9940","6161","1231","6129","2027","6138","3019","3527","6271","6180","2481","3303","3288","2361","4528","5351","8111","6150","6165","3508","9914","1419","2349","6241","2436","8940","3406","8068","5475","6228","3064","2618","3494","2035","3536","6225","5478","4419","1416","2855","2434","6235","5204","8182","3287","2381","3094","2109","3450","5531","6234","5455","3114","5523","3297","1712","4416","8054","8287","2008","8107","5312","6170","3066","1713","2520","6021","3332","3535","2854","5516","3431","2413","2032","6145","5345","1516","8081","9958","5009","6223","6233","8040","3055","8008","3191","2841","8266","2607","3339","3481","3545","1437","6154","2371","8101","3557","2388","6255","6171","1810","3014","3063","6127","5608","2323","3009","6142","2012","3498","2456","3308","1603","5491","8201","2014","3465","1906","1612","6116","5353","5302","6022","2363","8383","6146","1336","6227","8105","3054","1513","2439","3356","2475","1560","6016","2024","6298","2022","3034","5016","2916","2362","8021","3232","8047","2613","5321","9962","4535","2360","2340","6191","2059","1457","6243","2606","8299","1565","8050","2359","1785","3080","3443","3518","2460","8261","6166","2329","6005","5607","2365","1213","2424","2536","2369","2028","2856","5346","5326","1110","1440","2537","1523","3026","4114","2375","3083","3380","3090","5854","3029","5489","3041","2315","2030","6147","5201","3438","2025","5820","8088","4109","3252","6291","1474","3035","6111","1409","1815","3218","8905","2034","2504","8080","3289","4128","1616","2387","3434","6156","6124","1802","3416","6012","3046","8131","6217","5383","2476","9904","3049","8103","8099","5381","1218","1737","5317","2901","9949","6015","1806","8084","1321","3031","3323","5466","2206","8936","2611","2107","2547","3454","6160","3059","4426","2905","2491","5432","2441","2415","6279","3466","2455","4706","1905","4721","1102","2615","6136","4414","2399","6197","3521","3313","4129","6261","2892","3057","1613","2426","3213","1314","3265","3030","2015","9945","5471","2884","2433","9943","3021","6270","3548","1583","5905","4532","5014","8033","2601","8034","2701","5512","6176","6118","8932","2707","1524","2891","5703","1708","1506","1402","3293","9933","1512","6112","2321","3008","5015","6215","2101","2391","8091","8070","2885","3354","1514","3005","1233","2836","1618","4502","1907","4908","1455","6277","2017","3025","6211","9926","3226","5902","6282","9928","1103","2511","1519","3088","2461","1615","1217","2443","3515","1447","3128","1731","1727","5347","8071","8067","1614","1459","2327","2816","9929","1104","8996","2102","3315","2542","9907","2812","1609","2302","5481","9935","1423","2023","8289","2379","2313","8077","5340","3372","3532","1526","9911","4415","1909","1463","1604","2305","1527","1733","9906","3073","1729","6230","2009","9912","2367","2886","2405","5492","3205","2404","8039","1229","2453","5439","1439","6179","1453","5529","2527","6509","1460","6139","2459","2029","2380","3230","2104","2364","2543","3540","6105","1313","2348","8277","3089","1413","2409","2204","2501","6185","1469","4510","3040","1220","3523","5704","2341","1504","6196","8110","1452","2401","2880","8114","8928","2472","3060","1784","9908","3038","8092","8931","8024","3095","9939","2201","9105","2509","3491","3085","2227","6117","5519","1436","3048","3032","2514","2834","6286","2377","2454","5452","1449","2492","6218","8083","1528","2427",
 	"5511",
  "6008","3367","1539","1324","2458","1410","1808","2468","2390","3093","6109","3531","2474","5515","4716","4526","6202","1454","2392","1215","3024","2850","4105","4506","2498","1101","4529","8941","2882","1456","4523","9905","1315","3036","5328","3551","4906","6152","4108","1710","2006","1736","2328","8112","2451","1225","5525","9934","2888","9955","2548","3189","6265","2605","1529","8074","2374","6175","8053","2809","6128","1725","8906","6289","2483","5460","1107","2010","2430","2356","2832","8016","2609","1718","6167","1517","2207","6141","6133","9941","2338","1702","2883","5211","2347","2608","6189","8937","3376","2002","6199","3556","2516","2538","2852","3062","3069","2833","2539","5904","1468","5301","2881","5202","6226","6206","2108","1473","8072","2908","9938","5388","6131","6023","2801","3221","2106","2906","4402","9930","3266","6284","1305","2887","3227","3219","1467","1451","3162","3229","1445","2449","8354","1722","4104","4123","8096","2450","2910","6183","3296","2337","3489","5603","2535","6155","4401","6274","1219","2482","5487","1446","1531","1472","3058","2837","3520","2384","2488","6222","5533","2351","2473","5306","8930","2889","2423","4904","5371","6119","5013","8255","1471","6198","2497","1904","2463","8926","2467","2890","2352","4303","8933","5392","8924","8043","5505","2325","1234","1108","5498","1417","5457","2303","2403","4121","1210","4205","9917","1435","1809","1444","6168","3455","1434","2614","8046","6195","8916","9918","9910","2103","3209","4720","1525","6120","5465","3419","1235","1507","8093","1477","1236","3264","6285","6113","2820","8349","1464","6216","5604","5521","2312","5609","3228","5425","8032","4530","2616","3360","6020","3033","1442","3516","1617","4903","2417","3042","4306","1465","2376","3311","8942","1323","5315","2444","6231","2617","6246","9944","6114","2345","2402","3130","2419","3211","3224","3028","2420","5007","2421","1721","2485","1301","3284","2457","9960","2414","6121","2314","4609","3087","1742","2530","3206","4533","1723","1605","4712","6164","2221","1109","2466","3305","9942","6205","3501","1781","6153","8908","5484","1608","3044","2464","2412","8927","6220","3003","8163","6184","2357","4103","2849","3115","3078","2838","1304","2477","2442","6188","5203","2331","6292","2506","8374","6269","2425","2903","1201","3533","2480","9951","4725","1522","2603","1227","4417","2393","5490","1535","2385","3522","1711","6151","3010","3702","3018","2851","6247","1704","1540","1724","3022","1734","9931","2350","5464","1726","5324","4527","2823","2324","6508","2354","4111","3037","8210","3701","1470","8044","8705","5305","1530","5450","3013","2406","5434","2912","2373","2446","6224","6248","2915","1716","6174","2431","5520","2493","6505","8938","2330","3290","5530","6259","3490","1303","5310","3045","2499","1326","1307","9950","6140","4119","1203","1476","6283","4702","2062","8183","1310","9925","2308","6123","6107","3217","2612","3484","2546","5410","2311","6207","1777","1521","5426","2438","8925","5488","2317","5468","4513","2114","4905","3402","5349","3362","1232","6605","4207","5102","6148","5356","6208","1709","4107","8078","9927","4106","6190","1720","1308","6257","4131","3260","1216","1533","6239","6210","8079","5344","6192","1582","6204","6275","9921","6281","8240","3325","2515","3312","3017","1532","3015","2428","2395","1569","1570","8109","3231","6173","3390","6135","1717","5355","6194","4714","3152","9924","9902","1558","3047","3056","1503","6213","2301","2353","5309","8249","1707","2471","5398","4707","6214","4126","1805","3004","3388","2921","5403","2486","3052","1325","3483","5384","1787","6172","2452","2526","1312","6203","2013","2105","9102","2316","6278","6603","8049","9937","3023","4305","4127","2368","1316","6201","2489","1580","2448","6126","3324","4102","1714","3299","5480","8042","5205","3061","2440","2033","4909","4711","2355","5212","6187","3526","1515","6186","1418","2437","3067","6169","5364","1537","2382","3474","2383","5438","1333","1432","1309","1715","4113","3294","5210","1701","6115","6287","8097","9946","1319","4304","1730","6290","3068","3002",
  "3011",
  "3373","1735","1541","6158","3027","6134","8929","8069","9919","2528","3202","6212","1732","4703","6108","4534","5314","8082","5469","1466","2904","2462","3071","6143","5493","9103","2358","6101","6238","2408",
  };
 static String[] qdate ={
  "20080608","20080615","20080622","20080629","20080706","20080713","20080720","20080727","20080803","20080810","20080817","20080824","20080831","20080907","20080914","20080921","20080928","20081005","20081012","20081019","20081109","20081116","20081123","20081130","20081207","20081214","20081221","20081228","20090104","20090111","20090118","20090125","20090208","20090215","20090222","20090301","20090308","20090315","20090322","20090329","20090405","20090412","20090419","20090426","20090503","20090510","20090517","20090524","20090531","20090607","20090614","20090621","20090628","20090705","20090712","20090719","20090726","20090802","20090809","20090816","20090822","20090829"
 } ;
 static public void main(String[] arg)throws Exception{
     DBConnection dbc = new DBConnection();
     Connection dc = dbc.getConnection();
     Statement dbstmt= dc.createStatement();
     for(int i=0; i<qsnum.length;i++)
     {
     	  for(int j=0; j<qdate.length;j++)
     	  {
          dbstmt.executeUpdate("INSERT INTO pTest2Minfo1 (snum,date,mname,total,totalM,avg,type)  select snum,date,mnum,Amount,MoneyAmt,Avg,'1' from pmamountinfo_week "
          +" where date = '"+qdate[j]+"' and snum='"+qsnum[i]+"'  order by Amount desc limit 3;") ;
          dbstmt.executeUpdate("INSERT INTO pTest2Minfo1 (snum,date,mname,total,totalM,avg,type)  select snum,date,mnum,Amount,MoneyAmt,Avg,'2' from pmamountinfo_week "
          +" where date = '"+qdate[j]+"' and snum='"+qsnum[i]+"'  order by Amount limit 3;") ;
         }
     }   
 }
 



}
